% ai-phishing-detection-dissertation/report/sections/3-research-methodology/data-preprocessing/data-cleaning-and-normalisation.tex

\subsubsection*{Data cleaning and normalisation}
When preprocessing phishing data, it requires domain-specific cleaning tactics to ensure that attack signatures are still intact when removing external noise. Here, both email and URL preprocessing are addressed, with best practices from studies such from \cite{zamir2020phishing} and \cite{ahmad2024across}.

\begin{enumerate}
  \item \textbf{Email-specific processing}
  \begin{itemize}
    \item \textit{HTML/formatting removal}:
    \begin{itemize}
      \item HTML tags can be stripped by using the Beautiful Soup Python library \cite{beautifulsoup2025} but with hyperlinks still preserved \citep{bravo2010bridging}.
      \item MIME encodings should be decoded, i.e. in printable or in Base64 format, to recover full text.
    \end{itemize}
    \item \textit{Header extraction}:
    \begin{itemize}
      \item Critical headers, such as "\texttt{From}", "\texttt{To}", "\texttt{Subject}", and "\texttt{Reply-To}", should be isolated.
      \item Any discrepancies in these headers should be flagged as potential phishing indicators \citep{lin2021phishpedia}.
    \end{itemize}
    \item \textit{Text normalisation}:
    \begin{itemize}
      \item All textual components should be converted to lower case, but relevant terms, e.g. "PayPal" or "login", should be preserved.
      \item Any Unicode homoglyphs should be handled via NFKC normalisation \citep{andriu2023adaptive}.
    \end{itemize}
  \end{itemize}
  \item \textbf{URL-specific processing}
  \begin{itemize}
    \item \textit{Defanging}:
    \begin{itemize}
      \item Common obfuscations, such as "\texttt{hxxp://}" $\Rightarrow$ "\texttt{http://}" and "dot" $\Rightarrow$ "\texttt{.}", should be applied to remove accidental URL clicking.
    \end{itemize}
    \item \textit{Canonicalisation}:
    \begin{itemize}
      \item Percent-coded characters should be decoded, e.g. "\texttt{\%20}" $\Rightarrow$ "space".
      \item Repeated URL path components should be removed, e.g. "\texttt{/./}" $\Rightarrow$ "\texttt{/}".
    \end{itemize}
    \item \textit{Query parameter handling}:
    \begin{itemize}
      \item URL parameters should be extracted for subsequent analysis, e.g. "\texttt{?id=123}" $\Rightarrow$ relevant feature "\texttt{has\_query=True}".
      \item Tracking tokens like "\texttt{utm\_source}" can further help reduce noise.
    \end{itemize}
  \end{itemize}
\item \textbf{Special cases}
\begin{itemize}
  \item \textit{Quoted text/forward chains}:
  \begin{itemize}
    \item Quoted text should be separated with heuristics, like "\texttt{>}" prefixes \citep{klimt2004enron}.
    \item Recent messages in email threads should be kept only.
  \end{itemize}
  \item \textit{Adversarial samples}:
  \begin{itemize}
    \item Nigerian fraud emails should be minimally cleaned so that it can retain inherent social engineering tactics, such as markers of urgency \citep{champa2024phishing}.
  \end{itemize}
\end{itemize}
\end{enumerate}
